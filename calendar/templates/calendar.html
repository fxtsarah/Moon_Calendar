{% extends "main.html" %}

{% block nav %}

<div class = menu>
    <div class=menuitem><a href="{{ url_for('start', year = prevyear, month = prevmonth, wk_start_day = wk_start_day)}}">previous</a></div>
    <div class=menuitem><h1>{{ monthname }} {{ year }}</h1></div>
    <div class=menuitem><a href="{{ url_for('start', year = nextyear, month = nextmonth, wk_start_day = wk_start_day)}}">next</a></div>
    <div class=menuitem style = "float: right; margin-top: 30px;"><a href="{{ url_for('start_add')}}">Add New Event</a></div>
    <div id = "pref-toggle" class=menuitem style = "float: right; margin-top: 30px;"><a>Preferences</a></div>
</div>

<div id = "preference_options" class = "preference_options">
    <form style = "display: block;"> 
        <b style = "display: block;"><p>First Day of the Week:</p></b>
        <div>
            <input type="radio" id="sun_start_radio" name="wk_start_day" value=1>
            <label for="sun_start_radio">Sunday</label> <br>
              
            <input type="radio" id="mon_start_radio" name="wk_start_day" value=0>
            <label for="mon_start_radio">Monday</label>
        </div>
        <input class= "submit_wk_start" type="submit" value="Apply">
    </form>
</div>

{% endblock %}

{% block container %}

<form> 
    <select name="month"> 
        <option value = 1>January</option>
        <option value = 2>February</option>
        <option value = 3>March</option>
        <option value = 4>April</option>
        <option value = 5>May</option>
        <option value = 6>June</option>
        <option value = 7>July</option>
        <option value = 8>August</option>
        <option value = 9>September</option>
        <option value = 10>October</option>
        <option value = 11>November</option>
        <option value = 12>December</option>
    </select>
    <input type="text" name="day" placeholder="day">
    <input type="text" name="year" placeholder="year">
<input class= "submit-button" type="submit" value="Go To Date">
</form>


<div class="day_info">
    <p class= "day_info_date"> {{ monthname }} {{ selected_day}}, {{ year }} </p>
    <p id="moonphase_info"> <b>Moon Phase: </b>
    {{ selected_phase }} </p>
   
    <p id="event_info">{% if event_list %}
    <b>Events: </b>
   
    {% for event in event_list %}
    {{ event["Name"] }} <br>
    {% endfor %}</p>
    
    {% endif %}
</div>

{% for day in week %}
    <div class="weekday">
        <div class="weekdaytxt">{{ day }}</div>
    </div>
{% endfor %}

{% for placeholder in placeholders %}
    <a class="day"></a>
{% endfor %}

{% for date, phase, pos in dates %}


{% if (date.day == selected_day) %}
     <a class="selectedday">
        <img src= "{{ pos | find_moon_image }}">
        <span class="daytxt">{{ date.strftime('%d') }}</span>
    </a>
{% else %}
    <a id = "{{ date.strftime('%d') }}" class="day"> 
        <img src= "{{ pos | find_moon_image }}" onclick='clickDayAjax("{{ date }}")'>
        <span class="daytxt">{{ date.strftime('%d') }}</span>
    </a>
{% endif %}
{% endfor %}

<script>
    // var selected_year;
    // var selected_month;
    // var selected_day = "{{ day }}";

    // function changeDay(new_day) {  
    //     var prev_day_element = document.getElementById(selected_day);
    //     if (prev_day_element != null) {
    //         prev_day_element.className = "day";
    //     }

    //     selected_day = new_day;
    //     var new_day_element = document.getElementById(selected_day);
    //     new_day_element.className = "selectedday";
    // }

    // function clickDay(date) {
    //     var new_day = date.substring(8, 10);
    //     changeDay(new_day);
    // }

    function clickDayAjax(date){
        //var new_day = $(this).attr(id);
        var new_day = date.substring(8,10);
        alert(new_day);
        $.ajax({
            url: "/?month=" + "{{ month }}" + "&day=" + new_day + "&year=" + "{{ year }}" + "&wk_start_day=" + "{{ wk_start_day }}"
            // /?month=1&day=2&year=2001
            //url: "{{ url_for('start', year = year, month = month, day = new_day, wk_start_day = wk_start_day)}}"
        }).done(function() {
            alert("done");
        })
    }

    $('#pref-toggle').click(
        () => {
        $(".preference_options").toggle(); 
        }
    )

</script>

{% endblock %}